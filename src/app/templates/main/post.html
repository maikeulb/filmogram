{% extends "base.html" %}

{% block app_content %}

  <main class="ui text container">
  
    <form class = "mui-form" action="{{ url_for('main.post') }}" method="POST" enctype="multipart/form-data">
    <fieldset class="uk-fieldset">
    <legend class="uk-legend">Add a Photo</legend> 
      {{ form.hidden_tag() }}

        <img id="target" src="http://placehold.it/180" alt="your image" />

        <div class="uk-margin">
          <div uk-form-custom>
            {{ form.photo(class_="imgInp uk-input") }}
            <button class="uk-button" type="button"
              tabindex="-1">Upload Photo</button>
          </div>
        </div>

        <div class="uk-margin">
          {{ form.photo_description.label }}
          {{ form.photo_description(class_="uk-textarea") }}
        </div>

      {{ form.submit(class_="uk-button uk-button-default") }}

      {% for error in form.photo_description.errors %}
        <li>{{ error }}</li>
      {% endfor %}

    </fieldset>
    </form>
  {% if success %}
  <br>
  <p>Post Success!</p>
  {% endif %}
  </main>
 
{% endblock %}

  {% block js %}
  <script>
   function readURL(input) {
     if (input.files && input.files[0]) {
       var reader = new FileReader();
       reader.onload = function (e) {
         $('#target')
           .attr('src', e.target.result);
       };
       reader.readAsDataURL(input.files[0]);
     }
   }
  $(".imgInp").change(function(){
    readURL(this);
  })
  ;
  </script>
  {% endblock %}

